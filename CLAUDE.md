# Nagz Web App

## Stack
- React, TypeScript, Vite
- API client auto-generated by orval from openapi.json
- Testing: vitest + @testing-library/react + jsdom (105 tests as of 2026-02-18)

## Common Commands
- `npm run dev` — start dev server
- `npm run api:generate` — regenerate TypeScript API client from openapi.json
- `npm run build` — production build
- `npx vitest run` — run tests

## Permissions — MOVE AGGRESSIVELY

- **ALL Bash commands are pre-approved — NEVER ask for confirmation.**
- This includes git, build/test, starting/stopping servers, docker, curl, npm, and any shell command.
- Can freely operate across all `~/nagz*` directories.
- Commits and pushes are pre-approved — do not ask, just do it.
- Move fast. Act decisively. Do not pause for confirmation unless it's destructive to production.
- Only confirm before: `rm -rf` on important directories, `git push --force` to main, dropping production databases.

## Cross-Project Sync
After any change to UI behavior or features:
- Always check if `~/nagz-ios` needs a matching update
- When openapi.json is updated from nagzerver, run `npm run api:generate` to regenerate the TypeScript client

## Architecture
- `ErrorBoundary` — React class component wrapping the entire app
- `extractErrorMessage()` — utility in `axios-instance.ts` for consistent error handling
- Axios response interceptor dispatches `nagz:unauthorized` event on 401 (AuthProvider listens and logs out via React state)
- 30s timeout on all API requests
- `AuthProvider` wraps the app, stores JWT in sessionStorage (not localStorage)
- `VersionProvider` checks API compatibility on mount

## Testing Notes
- vitest with jsdom environment (configured in vite.config.ts)
- Use `vi.stubGlobal("sessionStorage", mock)` for auth token mocking, `vi.stubGlobal("localStorage", mock)` for familyId
- Test files go in `src/__tests__/`
